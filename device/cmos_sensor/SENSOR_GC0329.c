#include "cmos_sensor.h"

#if DEV_SENSOR_GC0329 > 0

SENSOR_INIT_SECTION const unsigned char GC0329InitTable[]=
{

	0xfe , 0x80,
	0xfc , 0x16,
	0xfc , 0x16,
	0xfe , 0x00,


	0xfa , 0x00,// 00 11 06
	0x70 , 0x48,
	0x73 , 0x90,
	0x74 , 0x80,
	0x75 , 0x80,
	0x76 , 0x94, //80 jambo 
	0x77 , 0x62,
	0x78 , 0x47,
	0x79 , 0x40,

	0x03 , 0x02,
	0x04 , 0x40,


	////////////////////analog////////////////////
	0xfc , 0x16,
	0x09 , 0x00,
	0x0a , 0x02,
	0x0b , 0x00,
	0x0c , 0x02,
	0x17 , 0x15,// normal 0x14    mirror  0x15
	0x19 , 0x05,
	0x1b , 0x24,
	0x1c , 0x04,
	0x1e , 0x08,
	0x1f , 0x08, //C8 
	0x20 , 0x01,
	0x21 , 0x48,
	0x22 , 0xba,
	0x23 , 0x22,
	0x24 , 0x16,


	////////////////////blk////////////////////
	////added for MID
	0x26 , 0xf4, //BLK
	0x2a , 0x2c,
	0x2b , 0x2c,
	0x2c , 0x2c,
	0x2d , 0x2c,


	0x26 , 0xf7, //BLK
	0x28 , 0x7f, //BLK limit
	0x29 , 0x00,
	0x32 , 0x00, //04 darkc
	0x33 , 0x20, //blk ratio
	0x34 , 0x20,
	0x35 , 0x20,
	0x36 , 0x20,

	0x3b , 0x04, //manual offset
	0x3c , 0x04,
	0x3d , 0x04,
	0x3e , 0x04,

	////////////////////ISP BLOCK ENABLE////////////////////
	0x40 , 0xff,
	0x41 , 0x24,//[5]skin detection
	0x42 , 0xfa,//disable ABS 
	0x46 , 0x03,
	0x4b , 0xca,
	0x4d , 0x01,
	0x4f , 0x01,
	0x70 , 0x48,

	////////////////////DNDD////////////////////
	0x80 , 0x07, // 0xe7 20140915
	0x81 , 0xc2, // 0x22 20140915
	0x82 , 0x98, //0x90        DN auto DNDD DEC DNDD //0e //55 jambo
	0x83 , 0x05,
	0x87 , 0x40, // 0x4a  20140915  

	////////////////////INTPEE////////////////////
	0x90 , 0x8c, //ac
	0x92 , 0x05,
	0x94 , 0x05,
	0x95 , 0x4d, //edge  0x45  
	0x96 , 0x88, 

	////////////////////ASDE////////////////////
	0xfe , 0x01,
	0x18 , 0x22, 
	0xfe , 0x00,
	0x9c , 0x0a,
	0xa0 , 0xaf,
	0xa2 , 0xff, 
	0xa4 , 0x30, //50 jambo 
	0xa5 , 0x31, 
	0xa7 , 0x35, 

	////////////////////RGB gamma////////////////////
	0xfe , 0x00,
	0xbf , 0x0b,
	0xc0 , 0x1d,
	0xc1 , 0x33,
	0xc2 , 0x49,
	0xc3 , 0x5d,
	0xc4 , 0x6e,
	0xc5 , 0x7c,
	0xc6 , 0x99,
	0xc7 , 0xaf,
	0xc8 , 0xc2,
	0xc9 , 0xd0,
	0xca , 0xda,
	0xcb , 0xe2,
	0xcc , 0xe7,
	0xcd , 0xf0,
	0xce , 0xf7,
	0xcf , 0xff,


	////////////////////Y gamma////////////////////
	0xfe , 0x00,
	0x63 , 0x00,
	0x64 , 0x06,
	0x65 , 0x0d,
	0x66 , 0x1b,
	0x67 , 0x2b,
	0x68 , 0x3d,
	0x69 , 0x50,
	0x6a , 0x60,
	0x6b , 0x80,
	0x6c , 0xa0,
	0x6d , 0xc0,
	0x6e , 0xe0,
	0x6f , 0xff,
	 
	 
	//////////////////CC///////////////////

	0xfe , 0x00,
	0xb3 , 0x42,//r  42
	0xb4 , 0xff,//g
	0xb5 , 0x0b,//b  06
	0xb6 , 0xf0,
	0xb7 , 0x44,
	0xb8 , 0xf0,


	// crop 
	0x50 , 0x01,


	////////////////////YCP////////////////////
	0xfe , 0x00,

	0xd0 , 0x40,
	0xd1 , 0x35,// 28// ???2?????  cb  saturation
	0xd2 , 0x30,// 28// ???2?????  cr

	0xd3 , 0x48, //contrast 0x40
	0xd5 , 0x00,

	0xdd , 0x14, 
	0xde , 0x34, 

	////////////////////AEC////////////////////
	0xfe , 0x01,
	0x10 , 0x40, // before Gamma 
	0x11 , 0x21, //
	0x12 , 0x13,	// center weight *2
	0x13 , 0x4e,  // 52  // AE Target // ???????    //new:0x72  old:0x52
	0x17 , 0xa8,	//88, 08, c8, a8
	0x1a , 0x23,
	0x20 , 0x31,	//AEC stop margin
	0x21 , 0xf0, // c0 //????|???????
	0x22 , 0x80, // 60 //????|???????
	0x3c , 0x50,
	0x3d , 0x40, 
	0x3e , 0x45, //read 3f for status

	////////////////////AWB////////////////////

	0xfe , 0x01,
	0x06 , 0x12,
	0x07 , 0x06,
	0x08 , 0x9c,
	0x09 , 0xee,
	0x50 , 0xfc,
	0x51 , 0x28,
	0x52 , 0x10,
	0x53 , 0x20,
	0x54 , 0x12,
	0x55 , 0x16,
	0x56 , 0x30,
	0x58 , 0x60,
	0x59 , 0x08,
	0x5a , 0x02,
	0x5b , 0x63,
	0x5c , 0x35,
	0x5d , 0x72,
	0x5e , 0x01,
	0x5f , 0x40,
	0x60 , 0x40,
	0x61 , 0xc8,
	0x62 , 0xa0,
	0x63 , 0x40,
	0x64 , 0x50,
	0x65 , 0x98,
	0x66 , 0xfa,
	0x67 , 0x80,
	0x68 , 0x60,
	0x69 , 0x90,
	0x6a , 0x40,
	0x6b , 0x39,
	0x6c , 0x30,
	0x6d , 0x60,
	0x6e , 0x41,
	0x70 , 0x10,
	0x71 , 0x00,
	0x72 , 0x10,
	0x73 , 0x40,
	0x80 , 0x60,
	0x81 , 0x50,
	0x82 , 0x42,
	0x83 , 0x40,
	0x84 , 0x40,
	0x85 , 0x40,
	0x74 , 0x40,
	0x75 , 0x58,
	0x76 , 0x24,
	0x77 , 0x40,//awb  r
	0x78 , 0x25,//awb  g  20
	0x79 , 0x62,
	0x7a , 0x58,
	0x7b , 0x20,
	0x7c , 0x30,
	0x7d , 0x35,
	0x7e , 0x10,
	0x7f , 0x08,


	///////////////////ABS///////////////////////
	0x9c , 0x00,
	0x9e , 0xc0,
	0x9f , 0x40,

	////////////////////CC-AWB////////////////////
	0xd0 , 0x00,
	0xd2 , 0x2c, 
	0xd3 , 0x80,

	///////////////////LSC //////////////////////

	0xfe , 0x01,
	0xc0 , 0x0b,
	0xc1 , 0x07,
	0xc2 , 0x05,
	0xc6 , 0x0b,
	0xc7 , 0x07,
	0xc8 , 0x05,
	0xba , 0x39,
	0xbb , 0x24,
	0xbc , 0x23,
	0xb4 , 0x39,
	0xb5 , 0x24,
	0xb6 , 0x23,
	0xc3 , 0x00,
	0xc4 , 0x00,
	0xc5 , 0x00,
	0xc9 , 0x00,
	0xca , 0x00,
	0xcb , 0x00,
	0xbd , 0x2b,
	0xbe , 0x00,
	0xbf , 0x00,
	0xb7 , 0x09,
	0xb8 , 0x00,
	0xb9 , 0x00,
	0xa8 , 0x31,
	0xa9 , 0x23,
	0xaa , 0x20,
	0xab , 0x31,
	0xac , 0x23,
	0xad , 0x20,
	0xae , 0x31,
	0xaf , 0x23,
	0xb0 , 0x20,
	0xb1 , 0x31,
	0xb2 , 0x23,
	0xb3 , 0x20,
	0xa4 , 0x00,
	0xa5 , 0x00,
	0xa6 , 0x00,
	0xa7 , 0x00,
	0xa1 , 0x3c,
	0xa2 , 0x50,
	0xfe , 0x00,
	//////////////////// flicker ///////////////////
	0x05, 0x02,
	0x06, 0x2c, 
	0x07, 0x00,
	0x08, 0xb8,
			
	0xfe, 0x01,
	0x29, 0x00,	//anti-flicker step [11:8]
	0x2a, 0x60,	//anti-flicker step [7:0]
			
	0x2b, 0x02,	//exp level 0  14.28fps
	0x2c, 0xa0, 
	0x2d, 0x03,// 03	//exp level 1  12.50fps
	0x2e, 0xc0,// 00 
	0x2f, 0x03,// 03	//exp level 2  10.00fps
	0x30, 0xc0,// c0
	0x31, 0x03,// 05	//exp level 3  7.14fps
	0x32, 0xc0,// 40 
	0x33, 0x20, 
	0xfe, 0x00,
	
	////////////////////out ///////////////////
	
	0x44 , 0xa2,
	0xf0 , 0x07,
	0xf1 , 0x01,	

-1,-1};

static void GC0329_rotate(u32 r)
{
	unsigned char buf[2];
	buf[0] = 0x17;		//0',180'
	buf[1] = 0x14|(r<<0);
	//	sensor_iic_enable();
	//	sensor_iic_info();	
	sensor_iic_write(buf);
	//   sensor_iic_disable();
}

static void GC0329_hvblank(u32 h,u32 v)
{
	u32 i;
	const u8 t[][2] = {
		{0x05,h >> 8},//HB[11:8]
		{0x06,h & 0xff},//HB[7:0]
		{0x07,v >> 8},//VB[11:8]
		{0x08,v & 0xff},//VB[7:0]
	};
	//	sensor_iic_enable();
	//	sensor_iic_info();		
	for(i=0;i<4;i++)
		sensor_iic_write((u8 *)&t[i][0]);
	//   sensor_iic_disable();	
}

SENSOR_OP_SECTION const Sensor_Op_t gc0329_cmd= 
{ 
	.typ = CSI_TYPE_YUV422,
	.pixelw = 640,
	.pixelh= 480,
//	.pixelw = 320,
//	.pixelh= 240,
	.hsyn = 1,
	.vsyn = 1,
	.AVDD = SYS_VOL_V3_0,
	.DVDD = SYS_VOL_V3_0,
	.VDDIO = SYS_VOL_V3_0,
	.colrarray = 2,//0:_RGRG_ 1:_GRGR_,2:_BGBG_,3:_GBGB_
	.rotate_adapt = {0},
	.hvb_adapt = {42000000,1120,0,0,0xff,25,0},
	.mclk = 24000000,
	.p_fun_adapt = {NULL,NULL,NULL},

};

SENSOR_HEADER_ITEM_SECTION const Sensor_Init_t gc0329_init=
{
	.sensor_struct_addr =	(u32 *)&gc0329_cmd,   
	.sensor_struct_size = sizeof(Sensor_Op_t),
	.sensor_init_tab_adr =	(u32 *)GC0329InitTable,     
	.sensor_init_tab_size = sizeof(GC0329InitTable),
	.id               =	0xc0,                 
	.w_cmd            =	0x62,                 
	.r_cmd            =	0x63,                 
	.addr_num         =	0x01,                 
	.data_num         =	0x01,                 
	.id_reg           =	0x00                  
};

#endif

